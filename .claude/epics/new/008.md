---
title: 简历优化三步流程
issue_id: 008
status: ready
priority: high
assigned_to: unassigned
created: 2025-10-26T16:07:52Z
last_updated: 2025-10-26T16:07:52Z
version: 1.0
author: Claude Code PM System
epic: new
labels: ["task", "workflow", "frontend", "integration"]
parallel: false
depends_on: [006, 007]
estimated_hours: 14
story_points: 9
---

## 任务008：简历优化三步流程

### 描述
实现完整的简历优化工作流程，包括文件上传、配置选择、结果展示三个步骤。这是第二阶段的核心用户流程任务，将各个独立功能模块整合成完整的用户体验。

### 验收标准
- [ ] 创建三步流程向导组件（Upload → Config → Result）
- [ ] 实现步骤间的状态管理和数据流转
- [ ] 集成文件上传组件（任务007）
- [ ] 创建优化配置选择界面
- [ ] 实现简历解析结果展示
- [ ] 创建优化结果对比和预览功能
- [ ] 添加进度指示和加载状态
- [ ] 实现结果导出功能（PDF/DOCX）

### 技术细节
- 使用React Context管理全局流程状态
- Framer Motion实现步骤切换动画
- TypeScript严格类型定义，完整的状态管理
- 集成N8N API（任务006）进行简历处理
- 响应式设计，移动端适配
- 状态持久化，支持刷新页面后恢复

#### 组件结构：
```
src/components/
├── workflow/
│   ├── ResumeOptimizer.tsx    # 主流程组件
│   ├── StepIndicator.tsx      # 步骤指示器
│   ├── UploadStep.tsx         # 上传步骤组件
│   ├── ConfigStep.tsx         # 配置步骤组件
│   ├── ResultStep.tsx         # 结果步骤组件
│   ├── ResumePreview.tsx      # 简历预览组件
│   └── ComparisonView.tsx     # 对比视图组件
├── context/
│   └── WorkflowContext.tsx    # 工作流状态管理
└── lib/
    ├── workflow-utils.ts      # 工作流工具函数
    └── export-utils.ts        # 导出工具函数
```

#### 工作流状态管理：
```typescript
interface WorkflowState {
  currentStep: 1 | 2 | 3;
  uploadData: {
    files: File[];
    uploadedFiles: UploadedFile[];
  };
  configData: {
    targetRole: string;
    optimizationLevel: 'basic' | 'advanced' | 'expert';
    focusAreas: string[];
    customInstructions?: string;
  };
  resultData: {
    originalResume: ParsedResume;
    optimizedResume: OptimizedResume;
    improvements: ResumeImprovement[];
    score: number;
    processingTime: number;
  };
  isProcessing: boolean;
  error: string | null;
}

interface WorkflowContextType {
  state: WorkflowState;
  actions: {
    nextStep: () => void;
    previousStep: () => void;
    goToStep: (step: number) => void;
    updateUploadData: (data: Partial<WorkflowState['uploadData']>) => void;
    updateConfigData: (data: Partial<WorkflowState['configData']>) => void;
    updateResultData: (data: Partial<WorkflowState['resultData']>) => void;
    setProcessing: (isProcessing: boolean) => void;
    setError: (error: string | null) => void;
    resetWorkflow: () => void;
  };
}
```

#### 核心组件API：
```typescript
interface ResumeOptimizerProps {
  onCompletion?: (results: WorkflowResult) => void;
  initialStep?: number;
  allowSkip?: boolean;
  showProgress?: boolean;
  className?: string;
}

interface StepIndicatorProps {
  currentStep: number;
  totalSteps: number;
  stepTitles: string[];
  completedSteps: number[];
  onStepClick?: (step: number) => void;
}

interface ConfigStepProps {
  targetRoles: string[];
  optimizationLevels: OptimizationLevel[];
  focusAreas: FocusArea[];
  onNext: (config: ConfigData) => void;
  onPrevious: () => void;
}
```

### 依赖关系
- 设计系统组件库（任务001）
- 项目基础架构（任务002）
- 主题系统配置（任务003）
- 核心页面路由（任务004）
- 着陆页开发（任务005）- 可能需要从此页面跳转
- N8N Webhook集成（任务006）- 核心后端服务
- 文件上传组件（任务007）- 第一步核心功能

### 工作量估算
- **工作流状态管理**：3小时
- **主流程组件开发**：2小时
- **上传步骤集成**：1.5小时
- **配置步骤开发**：2小时
- **结果步骤开发**：3小时
- **步骤指示器和导航**：1小时
- **动画和过渡效果**：1小时
- **状态持久化和错误处理**：1.5小时
- **总计**：14小时

### 完成标准
1. ✅ 三步流程完整工作，数据流转正确
2. ✅ 步骤间切换流畅，动画效果良好
3. ✅ 文件上传和API调用正常工作
4. ✅ 配置选择界面直观易用
5. ✅ 结果展示清晰，对比功能完善
6. ✅ 错误处理完善，用户体验友好
7. ✅ 响应式设计，移动端体验良好

### 验证命令
```bash
# 开发环境测试
npm run dev

# 工作流集成测试
npm run test:workflow

# 端到端测试
npm run test:e2e

# 状态管理测试
npm run test:state

# 性能测试
npm run test:performance
```

### 流程详细设计

#### 步骤1：上传 (Upload)
- 集成文件上传组件
- 支持多文件上传
- 文件预览和管理
- 基础文件验证

#### 步骤2：配置 (Config)
- 目标职位选择（预设+自定义）
- 优化级别选择（基础/高级/专家）
- 重点关注领域选择
- 自定义说明输入

#### 步骤3：结果 (Result)
- 原始简历vs优化简历对比
- 改进建议详细展示
- 优化评分和指标
- 导出功能（PDF/DOCX）

### 数据流设计
```typescript
// 完整的数据流示例
const workflowFlow = {
  // 步骤1：上传
  upload: {
    input: 'user uploads files',
    processing: 'file validation + upload',
    output: 'uploadedFiles array',
    nextState: 'config'
  },

  // 步骤2：配置
  config: {
    input: 'user selects optimization options',
    processing: 'validate configuration',
    output: 'optimizationConfig',
    nextState: 'processing'
  },

  // 处理阶段
  processing: {
    input: 'uploadedFiles + optimizationConfig',
    processing: 'call N8N APIs',
    output: 'optimizationResults',
    nextState: 'result'
  },

  // 步骤3：结果
  result: {
    input: 'optimizationResults',
    processing: 'format and display results',
    output: 'completed workflow',
    nextState: 'complete'
  }
};
```

### 错误处理策略
- **文件上传失败**：重试机制 + 详细错误提示
- **API调用超时**：自动重试 + 进度显示
- **解析失败**：文件格式提示 + 重新上传选项
- **网络错误**：离线提示 + 恢复后继续处理

### 性能优化
- 组件懒加载，减少初始Bundle大小
- API响应缓存，避免重复请求
- 虚拟滚动处理大文件列表
- 图片压缩和优化

### 备注
这是整个应用的核心用户流程，需要确保各个模块之间的无缝集成。重点关注用户体验的流畅性和错误处理的友好性。建议实现状态持久化，避免用户因页面刷新而丢失进度。考虑添加引导提示和帮助文档，降低用户的学习成本。